module Test_nonconvex_lasso

using FrankWolfe
using LinearAlgebra
using Test

using ReverseDiff

n = Int(1e3);
k = 1e3

const xp = [
    0.0018327730915495884,
    0.0015937445400959808,
    0.0009003382186464693,
    0.00127674793046702,
    0.0006658776107376128,
    0.0009205191029860242,
    0.00027120179250720086,
    0.0009568842164119253,
    0.00017141310989939967,
    0.001347806785639984,
    0.0003756549468906054,
    0.0007789830301650535,
    0.001595951059883138,
    0.0017491871177131065,
    0.0009094333338028251,
    0.00032279243212319814,
    0.0013569096800504516,
    0.001677147584151164,
    0.0015391601930021873,
    0.0012807239501508665,
    0.0019255304798025477,
    0.00023696519116144844,
    0.0006740990642088303,
    0.0008992907160919711,
    0.00095870146293443,
    0.0006020079336399129,
    0.0010793591147014374,
    0.001864192678347287,
    0.0002308616941410699,
    0.0008644771563767688,
    0.00011160498970751212,
    0.001457799362289775,
    0.0013792778071976559,
    0.0004811695430442883,
    0.00034652238673556646,
    0.00046014305343247284,
    0.0015200893325180345,
    0.0002301285029006331,
    0.0008702304234927531,
    0.0012559598183726735,
    0.0011129546632819363,
    0.0005924988153445136,
    4.029384857735469e-6,
    0.0004709756145071431,
    0.001964605871887013,
    0.0019007658592948712,
    0.0003175280568686617,
    0.00039519359524807865,
    0.0018984336958403536,
    0.00027524051594478207,
    0.0011443101479584885,
    0.0003446994490265905,
    0.0008851891434967485,
    0.0005551756905603518,
    0.0018906802245579875,
    0.00127509121720447,
    0.00023109190134164496,
    0.0011141821288208186,
    0.0018872937629987984,
    0.0009656897039301153,
    0.0009532709255962198,
    0.0018637789347380547,
    0.001567190536468948,
    0.001422748584770761,
    0.0015038111175217637,
    0.001470223281296216,
    0.0006692664383454796,
    0.0007199826094187467,
    0.0019426711913402464,
    0.0008483592078579399,
    0.0008659318305379398,
    0.000615960609169843,
    0.0003876017221507564,
    0.001979247539067491,
    0.0001842352837771119,
    0.0011614929182100495,
    0.00043021373329181663,
    0.00022434235551424179,
    0.0013566339830943827,
    0.00112751490494151,
    0.0004441973280647759,
    0.0004523257699007264,
    0.001995937554057902,
    0.0013376248691849492,
    0.00015724480210718667,
    0.0006843396921256714,
    5.149177140935245e-5,
    0.0019135234282829678,
    0.001423223867003027,
    0.0006690575109012296,
    0.00043940829722780174,
    0.0015482987671160563,
    0.000991235623826253,
    0.0010451879323598004,
    0.0019721353656970766,
    0.001590537575435224,
    0.00036036301467069667,
    0.0005176089802895095,
    0.0010964623938275284,
    0.0011604195508755576,
    0.001963154346838054,
    0.0008010390363287148,
    0.0009462694088848839,
    0.0004487482167006418,
    0.001067704128654275,
    0.0009187332598713647,
    0.001224663566414967,
    0.000581728212569191,
    0.0011368643516045912,
    0.00024573840310845727,
    0.0016702918025943037,
    5.641405301041516e-5,
    0.0005167751816708099,
    0.001279793338713246,
    0.0007453637256759483,
    0.0008758581662037049,
    0.0006068813117986329,
    0.0008160383784232987,
    0.0011990616276158746,
    0.000611394554624924,
    0.0016351307828542825,
    0.0006295201546188641,
    0.0010249124806352876,
    0.001528135509295967,
    0.001134372045321598,
    0.0014853708145065292,
    0.0006835751262166197,
    0.00017557291210234296,
    0.0015858504246131675,
    0.001072957085286627,
    0.0007879608107194755,
    0.0013573604649446678,
    0.00024909955148385253,
    8.599468740495325e-5,
    0.001183363772711265,
    0.00041115642853549656,
    0.0016427071795206498,
    0.0007850228455109578,
    0.000882246807024765,
    0.001657972127389477,
    0.0002545493704343697,
    0.0013542503275953003,
    0.0002754785733604482,
    0.0008402610320146713,
    0.0013554538850161736,
    0.00026437286516741316,
    0.0012896209175443083,
    0.00024335878706301038,
    0.0006212177218613426,
    0.0010692529838315853,
    0.001859173765777184,
    0.00045723538152473456,
    0.0011965370852645295,
    0.001989156509834248,
    0.0016587458139964203,
    0.0018819703658640914,
    0.0009040276708432154,
    0.00100556922903474,
    0.0005708785341158682,
    0.00011432643737059414,
    0.0009428388537883419,
    0.0009730278255207023,
    0.00031013209589278326,
    0.0018638085143026968,
    0.0002542934827502082,
    0.0008811444669717845,
    0.001715865848796056,
    0.000434684515180993,
    0.0006618322680616472,
    0.0009768754962879852,
    0.0017403821107680089,
    0.0017408714391316086,
    0.00042231619868889785,
    0.0011296323060238076,
    0.0006896512905358444,
    0.000892203979687179,
    0.0004799202336923233,
    4.120695301449753e-5,
    0.00029747866685352645,
    0.0013970894468810448,
    0.0018488734714588605,
    0.00026144166803006953,
    0.00012472565360705865,
    0.001336100105033711,
    0.00027304137640162755,
    0.0009954333529294166,
    0.0007635781298635778,
    0.0019404585702107204,
    9.417181338508956e-5,
    0.0013061086848206894,
    0.0018599745118614143,
    0.0014184356327043514,
    0.0018847774134689165,
    0.00198057265992906,
    0.0013899996374345273,
    0.001033418090673071,
    0.001172126183766991,
    0.0002491786408107791,
    0.0005316957443559164,
    0.0006581696066886157,
    0.0003111388677669472,
    0.0013364036523598078,
    0.0010094442574075531,
    0.0018497795791833848,
    0.0007323593213486288,
    0.0003055285971263878,
    0.0013538279134556262,
    9.486425007325548e-5,
    0.0014637604377913654,
    0.0001212269616937176,
    0.001172059377299153,
    0.001014748257755874,
    0.0005763212815496139,
    0.00010146351070545468,
    0.0007448504926006604,
    0.0008578913284180479,
    0.0013317184488653815,
    0.00011830847887435931,
    0.001848310085883006,
    0.0013499328132704855,
    0.00019597389916035896,
    0.0007566890546595535,
    0.00193254794702912,
    0.0003974847588399935,
    0.0003780810792390995,
    0.0014499682416200073,
    0.0002497113831378613,
    0.0009073444954380593,
    0.0006941328804333382,
    0.0012640877423129933,
    0.000956649843209072,
    0.0013484310578948753,
    0.0004053245252322041,
    0.0009670794712490947,
    0.0012668876492248867,
    0.001619080719097944,
    0.0005214918544308543,
    0.0011020109049342662,
    0.0016483535866867157,
    0.0018949856236975067,
    0.0012733752297767944,
    0.000655909883713231,
    0.001872033168679548,
    0.001386767453616496,
    0.000324304586025684,
    0.0010195007157271303,
    0.0016783078026951603,
    0.001575541373452696,
    0.0007927853201302792,
    0.0013969059422181385,
    6.615768882254124e-5,
    0.0014878756983712294,
    0.0005875526142880978,
    0.0005297963171169012,
    0.0012498806378430454,
    0.0005758184096768597,
    0.0019419526045771737,
    0.0009012191764821094,
    6.75978463586831e-5,
    0.0011630860329974583,
    0.0007236986389638974,
    0.001476215932609905,
    0.0005086352610106773,
    0.0016077714105984552,
    0.0006951187838680796,
    0.0013837315552207522,
    0.000502193416509755,
    0.0005580479763147728,
    0.00048295234148723766,
    0.0015666666260128485,
    0.0006769227398960468,
    0.001985142955532955,
    0.00014267315129373005,
    0.001902027829023448,
    0.0012042027553697252,
    0.00035670565654386823,
    0.0006346847709761202,
    0.00091952046224069,
    0.0005176537762145475,
    0.0016748877821021774,
    0.0003978806450037573,
    0.0006035334678798834,
    0.0017219568486774594,
    0.0009018821122855186,
    0.001619653379346616,
    0.001022433562073428,
    0.001072698094039503,
    0.0002038033359344979,
    5.9798836285713143e-5,
    0.00026374530352058515,
    0.0018102475893269315,
    0.00027553830387046344,
    0.0009659885159881312,
    0.0007561721143300964,
    0.000788532484485178,
    0.0010799488789369346,
    0.0014724053628774657,
    0.00031993817917332936,
    0.0006177208319393205,
    0.001817700677353197,
    7.907170625981359e-5,
    1.5573454383827163e-5,
    0.00013866026421001314,
    0.0017151636564962322,
    0.0006552577530620876,
    0.0019485177145897557,
    0.001190339592661393,
    0.0006808124346052569,
    0.0005954759845031083,
    0.0007985123103411901,
    0.0004487716911070913,
    0.0017200724960854817,
    0.0017804603634335539,
    0.0002765942521047776,
    0.0016635828139130629,
    0.0014743178504765277,
    0.0015799378616438004,
    0.0018315487485899213,
    0.0002695490107889182,
    0.0004531941431932836,
    0.0013073678046168643,
    0.0017611931961439794,
    0.0009474400441979527,
    0.0013257051128023254,
    0.0010488265848314314,
    0.0018716499251161885,
    0.0015751416901875258,
    0.001616065148123465,
    0.0002485613086217679,
    0.0013331056261160481,
    0.0005963315192220173,
    0.001379667879961323,
    6.110827617394757e-5,
    0.0015390710272743698,
    0.0019288923575271632,
    0.0010907948751852027,
    0.00045825506794575533,
    0.0005299259336476291,
    0.0006541212128494624,
    0.0007215258425467768,
    0.001860011774737959,
    0.0016031137007219795,
    0.0006464400832404255,
    0.001337677862036801,
    0.0004881065606806423,
    6.31421441759367e-5,
    0.0016567198686779677,
    0.0013610922427106382,
    0.0005926783572242435,
    0.001644571659827756,
    0.0010494173981636069,
    0.0014636575992381337,
    0.0009066449485358799,
    0.0015347892848303927,
    0.00045542685141215187,
    0.0003213560593230796,
    0.001374283359636623,
    0.0012785091435204832,
    0.0003967449594011047,
    0.0019454388715377015,
    0.00023242901737008408,
    0.0009423731928932567,
    0.0010383219002757925,
    0.001159227837391761,
    0.00043874465016032144,
    0.0004115595071388711,
    0.00039375096066401427,
    0.00032506183525874907,
    0.0010207819688146569,
    0.0015098348186148034,
    0.001905914555518725,
    0.0007735547422465331,
    0.0007814356326174461,
    0.0018113445797775924,
    0.001041894131565221,
    0.0008234594071261897,
    0.0012830657307808776,
    0.0007129334698624155,
    0.00037139060224222585,
    0.000803227267789403,
    0.0014041081256167703,
    1.5115266428794456e-5,
    0.0009473538554703247,
    0.0006720052663610818,
    0.0009975645074246971,
    0.001740678355869544,
    0.0008318298921779738,
    0.00019558339975096585,
    0.0019556291686982116,
    0.00057989682779768,
    0.0001810619870975473,
    0.001929890078977231,
    0.001585444128828578,
    0.0014466400010199392,
    0.0002578676668168679,
    0.00021370788420704937,
    0.00025616866541825324,
    0.001656862362405254,
    0.0006624098851719846,
    0.000488856922385659,
    0.0007550544332957089,
    0.0007819209255393643,
    0.001188378606226741,
    0.0009103461638397347,
    0.00033993681025744707,
    0.001775785231958221,
    0.0015927372059838405,
    0.0010072642203522364,
    0.0015663218484591947,
    0.0018377982520048507,
    0.0010905951969243956,
    0.00014769911241636265,
    0.0009457940869536025,
    0.000952939124557402,
    0.00015558729138893403,
    0.00035680989959007374,
    0.001010041550483024,
    0.0013790180501538133,
    7.802661175271037e-5,
    0.0014470730889533099,
    0.0006764473444719864,
    0.0013680396936119864,
    0.0007693620294454979,
    0.0019140342734339936,
    0.00029998689797259805,
    0.00019114086762915333,
    0.001219494007900234,
    0.0004976267897593667,
    0.00170295549282911,
    0.0019115982055067124,
    0.0014759907540537077,
    0.0009268002976558138,
    0.0007942730585019111,
    0.0007367326016035645,
    0.0014649228101122934,
    0.00015546969007001736,
    0.0010327516215610697,
    0.0007823597072905682,
    0.00014691349516334442,
    0.001245579612762418,
    0.0012786862771840485,
    0.00026684789160527747,
    0.0010638069764506988,
    0.0018297511062183812,
    0.0017225147118992356,
    0.0007248274739058347,
    0.0011179385716630138,
    0.0018209636507223034,
    0.0015592566390118473,
    0.0005909402616593415,
    0.00022673588707267515,
    0.00032818850151754763,
    0.0006990863186125467,
    0.001330417292136972,
    0.0015288810903385307,
    9.659083792112202e-5,
    0.0002467595466102719,
    0.0018691626524305267,
    0.0003327680377894402,
    0.0006728248645943384,
    0.0006878252387040834,
    0.0014801229392313985,
    6.050024855478439e-5,
    0.0004934161850992555,
    0.00024186508107116626,
    0.0013026045224702257,
    0.001729280198300807,
    0.0010612921637790688,
    0.0018477841502465614,
    0.00034739151174714646,
    0.000514703481587503,
    4.680165159905593e-5,
    0.00026048516380227396,
    0.0014591920580435773,
    0.0009241194510978197,
    0.0011134645001587605,
    0.0019788248722242075,
    0.0005708904371330058,
    0.001183232824004749,
    0.0008989131869314823,
    0.000508697824295855,
    0.0019707837972992165,
    0.0019698774911707313,
    0.0010600395092951556,
    0.0010310344513264004,
    0.001989637628077925,
    0.0006447386615129625,
    0.0012610054525879983,
    0.0007609677170144002,
    0.00017209698499650293,
    0.0009924697621285857,
    0.0003417824257821324,
    0.0008380097781683315,
    0.0007091561820366599,
    0.00164100413367772,
    0.0016507235595240861,
    0.0007399674864961309,
    0.0009511923987000143,
    0.001576376484942097,
    0.0019396844316881957,
    0.0006232944417178602,
    0.00036548031758296167,
    0.00108412611917197,
    0.0018005076506736246,
    0.0008195832730431881,
    0.0007834579740707772,
    0.00115251872513119,
    0.0018146600856659273,
    0.0005610582076963469,
    0.0003992005615304087,
    0.0018395995819174328,
    0.0013684936835912495,
    0.0015639647900724033,
    0.0008705811945658376,
    0.00024415743695937905,
    0.00034829983742813573,
    0.0014980360651382647,
    0.0019360937653995006,
    0.00012202998944119299,
    0.0006449676582695361,
    0.0008098166298812683,
    0.0005430125895007128,
    0.0006024776260324192,
    0.0014606536379434315,
    0.0002734577802465653,
    0.0015253026979302373,
    0.0014506490933473236,
    0.0009053434479656874,
    0.00024572429640966825,
    0.0017261423450467225,
    0.0006634173125104148,
    0.00020460005338718054,
    0.0010525111257583064,
    0.0011755345781089518,
    0.0009628201144621855,
    0.0018500696986080785,
    0.0013465030432382894,
    0.00044069758400812375,
    2.8918450831516968e-5,
    0.0005368905502858166,
    0.0004212772954105924,
    0.00015935697197428205,
    0.0015575191232223477,
    0.001969106260254529,
    0.0014523394370467837,
    0.0005143581758083439,
    0.001672614261106492,
    0.0003699072419913848,
    0.0005614157712179695,
    0.001443997282866257,
    0.0010924593046373545,
    0.0018438330886678704,
    0.0009172935921157529,
    0.0003334533180769076,
    0.0006053163936255821,
    0.0006975127051629411,
    0.0006447215855192593,
    0.0009038559384362273,
    0.0002851791737987819,
    0.0011100476801227251,
    0.0013818662120346737,
    0.0017274041637532517,
    0.00034973363028089824,
    0.00018254166991585696,
    0.0012421183189664415,
    0.0009404069996998386,
    0.00040059486716694756,
    0.0006761796808415352,
    0.0007879149566179274,
    0.0007036014935187577,
    0.001662460181387039,
    0.0013470682662865248,
    0.0008292356276266305,
    0.0009362777275760239,
    0.0001705735597972123,
    7.368511260263812e-5,
    0.0008504500507358879,
    0.001670104248747959,
    0.0013701465452743377,
    0.0011001260809050519,
    0.000707958148483138,
    0.0010920697390678362,
    0.0017173305597642078,
    0.0016707517326501149,
    0.0011916614402770495,
    0.00014950608258317054,
    0.0009999296822657462,
    0.0019265502401814149,
    0.0018866771155574614,
    0.0006901364742675106,
    0.0008116640346814735,
    0.0013824012324552197,
    0.00011988968352039541,
    6.724820191962071e-6,
    0.000541109474743525,
    0.0016004250972272815,
    0.0013925414647899105,
    5.0928854808417786e-5,
    0.0014858906573357426,
    0.0008402977780814168,
    0.00030705891469881737,
    0.0016622968358201938,
    0.0018576382398660578,
    0.0011286422361889267,
    0.001680487391637096,
    0.0018481482216813154,
    0.0005887932985531036,
    0.0006238451623384198,
    0.0002941429468529822,
    0.0018505281380446997,
    0.0007705752172602122,
    0.000521506971472071,
    0.001439169135086595,
    0.00022954255152772709,
    0.00016345214486571723,
    0.0005412805293540016,
    0.0009543096200045798,
    0.00030526309485633276,
    0.0004423504153004842,
    0.001331896818369305,
    0.00045537794071123165,
    0.0011494035415358244,
    0.0018559525354102475,
    0.0001617324331920188,
    7.404623539455066e-5,
    0.0007576313297505555,
    0.0010321230933840729,
    0.001125546423213475,
    0.0018491309553563813,
    0.0018047208197580816,
    0.001596928518166632,
    0.0009474773204987148,
    0.0013455193636407782,
    0.0004945025688660931,
    0.0016401142815766915,
    0.001461158510663254,
    0.0010801425312820174,
    0.00117543449937538,
    0.0001409859989388047,
    0.0014024237478710807,
    0.0010732135150098888,
    8.853927265193118e-5,
    0.0002292957339488554,
    0.00048564337909409705,
    0.0016791010259568423,
    0.0018404565027268429,
    0.0012256716819134595,
    0.0018977742433093328,
    0.0012193539431702405,
    0.0011129418826290895,
    0.0004300373551459786,
    0.0003096322110989376,
    0.0002937406996688144,
    0.0017445632310413364,
    0.0014698238963586933,
    0.0011637274665354054,
    0.00029988012187886907,
    0.0014078373638790641,
    0.0010920443388229288,
    0.0007616799501800092,
    0.0014784583110823103,
    0.0010369180317939433,
    0.0005315182434241679,
    0.0009443679112887697,
    0.0015379516725051836,
    0.0017899008573258213,
    0.0001264327161521128,
    0.000614104790564224,
    0.0005140137534280678,
    0.0019544467247925154,
    0.0003481060897639085,
    0.0011950184367434272,
    0.0006704325730648348,
    5.7789679651911883e-5,
    0.0008260463562314218,
    0.0004461525535082876,
    0.0017253165770362438,
    0.0004880111859461991,
    0.0012328442207703526,
    0.0012243847529723791,
    0.0010727209085667655,
    0.0015127088395774772,
    0.001705599984036084,
    0.001904262997230351,
    0.00046307896123850336,
    0.0006228713612049173,
    0.0016114970380151144,
    0.00028438852731265535,
    0.00011085157564455476,
    0.0006127371097982747,
    0.000865327118624887,
    0.00024375652128201108,
    0.0003125392182457938,
    0.0006581294516106818,
    0.001101645022209513,
    0.0010680663868787405,
    0.00024341940847275002,
    0.0007552071409940589,
    0.0002834719113987055,
    0.0015661662392179644,
    0.0004631422222631197,
    0.0009792865755230726,
    0.0019579247610371137,
    0.0016829964735991447,
    0.0017244751150614112,
    0.0017897389000213332,
    0.0008556092437764926,
    0.0007279064425182991,
    0.00048655245053037734,
    0.0012572693657413958,
    0.0010797783765996727,
    0.0008970205588488278,
    0.0014175272869761339,
    0.0013290864629511726,
    0.0005245496865571544,
    0.0009049967099332472,
    0.00043558140742005385,
    0.0011275812094613358,
    0.00017273450978678079,
    0.0012550804002917006,
    0.0012781743532617365,
    0.001573706848638644,
    0.0013420731679475095,
    0.0014892458739846888,
    0.0008398246235935519,
    0.00011504468581753147,
    0.00039446185221038004,
    0.0012376437036031238,
    0.0018295550910136938,
    0.0019546773576131814,
    0.0015676052058229864,
    0.001506851497019354,
    0.001575197683338677,
    0.0013763306886183757,
    0.0017616294821065815,
    0.0017435248930320643,
    0.0018050603700472292,
    0.0007503651034278091,
    0.0009299828674809712,
    0.0008756522416130647,
    0.0006362927222849365,
    0.00022210154903832706,
    0.001844332500822328,
    0.0013248403743752145,
    0.0012559998892230895,
    0.0018209525933688072,
    0.0007335271183528885,
    0.0014829191233771614,
    0.0018678613135984172,
    0.0011420653343152806,
    0.0006605953396670363,
    0.0008870568846896466,
    0.0004900459822860427,
    0.00025643224529566655,
    0.001421495117363536,
    0.001280223271089306,
    0.00023855521270485226,
    0.0012122575989886315,
    0.0009627510945446007,
    5.285953329532391e-5,
    0.0009454499005818052,
    0.0003700377574380651,
    9.077339687952929e-7,
    0.0014411222217378642,
    0.0014173964830437181,
    0.001226758073013107,
    0.0015510199657714305,
    0.001068549766336118,
    0.001481795750543556,
    0.000862743240234657,
    0.0018364178627223657,
    0.001297810444631,
    0.0017288638263618468,
    0.0014850128893871433,
    0.0003876118061773179,
    0.0006174093115518869,
    0.0001558241106405434,
    0.0017592029211481186,
    0.0005700169392640262,
    0.0007240705416604883,
    0.0011116298082459834,
    0.00013388249901906122,
    0.0009231516835718252,
    0.0007453818027215918,
    0.001902893165074062,
    0.0019350538421895446,
    0.0007527871635143145,
    0.0010257000169197053,
    0.0009903603971969308,
    4.4285426144378676e-5,
    0.001564381934935309,
    0.0015462480555508624,
    0.00029899868944819523,
    0.0015440779480220149,
    0.0007418648975127938,
    0.0019386004696501469,
    0.0019131630292562234,
    0.0015039026288142562,
    0.00019896075715630912,
    0.001293929283024881,
    0.0010641333867957457,
    0.0015197477936118194,
    0.0012564938842911909,
    0.0007840135152147756,
    0.0015727679647529198,
    0.0010820083599456722,
    3.8300252164584965e-5,
    0.001852308356736721,
    0.0011578408985434623,
    0.0018838742452490691,
    0.0006827104598831953,
    0.0004317043082294299,
    0.001255847208881049,
    0.001909609312654367,
    0.00028111392236356047,
    0.0012567089728115664,
    0.00035089323655110733,
    0.001591847528483122,
    0.0010543319691625778,
    0.0015210227188409,
    0.0006187872451775554,
    0.0006461464176754111,
    0.0012521503243518503,
    0.0010858832604493784,
    0.0019696825709546763,
    0.0004918204594470025,
    0.0014651421292231155,
    1.4381467369199035e-5,
    0.0019798021556332902,
    0.000621799009119485,
    0.001234777757265796,
    0.0013084057940826379,
    0.0007577985064971946,
    0.00048504609549452905,
    0.0006107784742234016,
    0.0005802471497523196,
    0.00046874808725753584,
    0.0006532405213221228,
    6.264346279392007e-5,
    0.0012680170832670627,
    0.0009316962372604156,
    0.0017697198580174584,
    0.001508387782426762,
    0.00041306458511965015,
    0.00026087438719267617,
    0.0011261602064797887,
    0.0019850451621984005,
    0.00023939598199659615,
    0.0017541385937419633,
    0.0013440822232875104,
    0.0010770467943507596,
    0.0018078683636017262,
    0.0015231183627278455,
    6.869221710248355e-5,
    0.00035195006157333456,
    0.0013762995791557688,
    0.0008072149205532919,
    0.0011353841005312634,
    0.0014865730965501383,
    0.0019307441257809916,
    0.0011667277507501342,
    0.0004294030938637975,
    0.00111365615933646,
    0.0014069834158223595,
    4.8710162869939384e-5,
    0.001436450945346649,
    0.0017242135369256516,
    0.00041730866559616447,
    0.0009829065577903772,
    0.001167055962634375,
    0.001508796966308683,
    0.0017893897976293015,
    0.001287771363148189,
    0.001997137544134502,
    0.0002145244269098374,
    0.001662766333988747,
    0.00036868657263025025,
    0.0007381648336162118,
    0.0013742760119370514,
    0.00011619435884379533,
    0.0010922699701567502,
    0.0014294553617263336,
    0.0008149134535309198,
    0.0011517173279784858,
    0.0005618245613695095,
    0.000921903951793312,
    0.0009024406687822501,
    0.0009017809865759639,
    0.0008223481994507508,
    0.0004962383638437895,
    0.0017603447995208604,
    0.000163248469761568,
    0.0011429136963764706,
    0.0018522434293814756,
    0.0002356312964772626,
    0.0010112992495719833,
    0.0014210738528094217,
    0.0010234170375453978,
    0.0012090556341396276,
    0.0015497166977694698,
    0.00032572146086334153,
    0.0011398813376043847,
    0.0015589966071929637,
    0.001902743947117522,
    0.0003739076464881413,
    0.0005822386500208485,
    0.000860476817346138,
    0.00041490200286679993,
    0.0016411990778428178,
    0.00032836239341761924,
    0.0014958156778162395,
    0.0012197218589056907,
    0.0018146597016257785,
    0.0014317525498898555,
    0.0018016245765188758,
    0.0006937041548007459,
    0.00033402346803317474,
    0.001406396085933951,
    0.0008651945073745998,
    0.0010878408091477782,
    0.0011322785846400354,
    0.0014529747440973576,
    0.00041560645703940513,
    0.001497228336849063,
    0.0015424355185953238,
    0.001869207847744262,
    0.0012428300004407441,
    0.0010937160906464953,
    0.0012007892623604646,
    0.0004721948120057884,
    0.000414959864788396,
    0.00062360561149615,
    0.00041807456438264527,
    0.0010052715695913102,
    0.0013384843013248635,
    0.0017928187389229999,
    0.001913993790030471,
    0.00023245030676397385,
    0.0014580749126802976,
    0.0004470042941235724,
    0.0011436280459967535,
    0.0011303445744775037,
    0.0012753735267050843,
    0.0016568858262784372,
    0.0017566569095932968,
    0.0005535250070063169,
    0.0009223820466287302,
    0.0008220756788574233,
    0.0011116760097243385,
    0.0014117799294308883,
    0.00087495129826821,
    0.0008111549551058168,
    0.0004048409662543526,
    0.000925904294106518,
    0.001359317625777248,
    0.0008899768972427336,
    0.001818912222220616,
    0.00105708599008006,
    0.0009376529134939358,
    0.001982571585694777,
    0.0018797434748223426,
    0.00046847491132920164,
    0.00015401643870465188,
    0.001882013352925305,
    0.0014891448179153227,
    0.0009715307625831949,
    0.0014754496527844365,
    0.0017764998980493963,
    0.001798214544781652,
    0.0017438490621810002,
    0.00020540323451424944,
    0.0009377724441468718,
    0.0011041741045957185,
    0.0009708990424034792,
    0.00044236028038968064,
    0.00037532641918069996,
    0.0014276455734683763,
    0.00018132726839262513,
    0.0002564970819513468,
    0.0006011127603836982,
    0.0008406696828283911,
    0.000263973972249628,
    0.0005468165821273978,
    0.00021476152125868216,
    0.0003268425577002223,
    0.0005780972992596821,
    0.0018720112477446783,
    0.0013828436790080526,
    0.0018673680178595189,
    0.0017363376985923286,
    0.0014766123499324088,
    0.0009136250184811881,
    0.0014356085455390168,
    0.0009559040137781322,
    0.0007535310369443493,
    0.0006742417823838604,
    0.0016826807157711873,
    0.0015410007790954772,
    0.0009228700085840383,
    0.000684659986697446,
]

@testset "Nonconvex Lasso" begin
    f(x) = 2 * norm(x - xp)^3 - norm(x)^2

    grad!(storage, x) = ReverseDiff.gradient!(storage, f, x)

    lmo = FrankWolfe.ProbabilitySimplexLMO(1.0)

    x0 = collect(FrankWolfe.compute_extreme_point(lmo, zeros(n)))

    res = FrankWolfe.frank_wolfe(
        f,
        grad!,
        lmo,
        x0,
        max_iteration=k,
        line_search=FrankWolfe.Nonconvex(),
        print_iter=k / 10,
        verbose=false,
    )

    x_true = [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0032135880125713457,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.00018516859804417726,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.006969188491359922,
        0.0056815531539352315,
        0.0,
        0.0,
        0.010176917272823348,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.02497013305042179,
        0.0,
        0.0,
        0.0,
        0.0016736801452988358,
        0.0,
        0.0,
        0.0027281478733080303,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.024440222424345428,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0038530911472075794,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.014663370095865949,
        0.0,
        0.0,
        0.0,
        0.0,
        0.007668232242457311,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.009257913756320776,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.020372781914532914,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.028408622282667544,
        0.0,
        0.0020357868035761253,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0002052828127294368,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.00434028659960034,
        0.0,
        0.0,
        0.0,
        0.0,
        0.00831818605260279,
        0.014107079016793556,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0035639712105067535,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0025091858915269175,
        0.0,
        0.0,
        0.018437396385970566,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.002673292094469775,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.00350462263228815,
        0.0,
        0.0022693707270134045,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.005005370084094529,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0005338245730249912,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.01737316561449022,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.009871321544713584,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.006942084588314515,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.005593883716777582,
        0.0,
        0.0,
        0.011803424931840265,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0019500739528989222,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0011400559223338504,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0007228936963650297,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.004236419618989145,
        0.0,
        0.0,
        0.0,
        0.0,
        0.015512718361240276,
        0.018805457372579944,
        0.0,
        0.0,
        0.02325487476395467,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0060555153949940176,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.023160291066307348,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.00470954218788022,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.03189188326685658,
        0.006214742198205494,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0302683076052642,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.01666497968574187,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.015536991862228424,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.003990711114431177,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.007555239590432756,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.027091239380948737,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0010229362419501592,
        0.0016230770642670785,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.010776728233836094,
        0.014180606406681152,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0004846083939801903,
        0.0,
        0.0,
        0.0,
        0.0017525633832993605,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.030349931926964724,
        0.0,
        0.0,
        0.0,
        0.013579202318466358,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.008553560562398952,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.005225344578416675,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.33935548951829697,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0018635600585753555,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.000653473729923748,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.004698420875116127,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.01269961364132544,
        0.009146813384144064,
        0.0,
        0.0,
        0.0015114518587757443,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0202881787824224,
        0.0,
        0.00012235625801301618,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
    ]

    primal_true = -0.039257619800701055

    @test norm(res[1] - x_true) ≈ 0 atol = 1e-6
    @test res[3] ≈ primal_true

end

end  # module
